# Модуль `app/auth_manager`

Этот модуль является центральным компонентом для управления аутентификацией и авторизацией в приложении "Интеллектуальный Мультибанковский Финансовый Советник". Он инкапсулирует всю логику, связанную с получением, хранением, кэшированием и обновлением токенов доступа для взаимодействия с банковскими API.

## Назначение

- **Централизация логики аутентификации:** Предоставляет единую точку для всех операций, связанных с токенами, устраняя дублирование кода и упрощая поддержку.
- **Поддержка OAuth 2.0:** Реализует стандартный поток `client_credentials` для получения токенов от серверов авторизации банков.
- **Безопасное хранение:** Взаимодействует со слоем `app/db` для безопасного (в зашифрованном виде) хранения токенов.
- **Кэширование:** Реализует in-memory кэширование токенов для повышения производительности и снижения количества запросов к серверам авторизации.
- **Валидация JWT:** Содержит логику для проверки JWT, используемых в межбанковских запросах, включая загрузку ключей из `JWKS` эндпоинтов.
- **Расширяемость:** Спроектирован с использованием абстрактных базовых классов, что позволяет легко заменять реализацию (например, на mock-объекты в тестах) и добавлять поддержку новых механизмов аутентификации в будущем (например, GOST).

## Компоненты

- `services.py`: Содержит основную бизнес-логику (`OAuth2AuthManager`).
- `schemas.py`: Pydantic-схемы для данных аутентификации.
- `dependencies.py`: Зависимости FastAPI для внедрения сервиса в эндпоинты.
- `exceptions.py`: Пользовательские исключения для обработки ошибок аутентификации.
- `router.py`: Эндпоинты, специфичные для управления аутентификацией.
